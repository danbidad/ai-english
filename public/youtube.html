<!DOCTYPE html>
<html lang="ko" ng-app="youtubeApp">

<head>
	<meta charset="euc-kr">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>ìœ íŠœë¸Œ ìë§‰ í”Œë ˆì´ì–´</title>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
	<script src="https://www.youtube.com/iframe_api"></script>
	<script src="common.js"></script>
	<script src="youtube.js"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
	<style>
		@media (prefers-color-scheme: dark) {
			body {
				background-color: #121212; /* ì–´ë‘ìš´ ë°°ê²½ ìƒ‰ìƒ */
				color: #e0e0e0; /* ë°ì€ ê¸€ì ìƒ‰ìƒ */

				input[type="text"],
				.current-time,
				.subtitle-item {
					background-color: #1e1e1e; /* ì–´ë‘ìš´ ë°°ê²½ */
					color: #e0e0e0; /* ë°ì€ ê¸€ì */
					border: 1px solid #333; /* ì§„í•œ í…Œë‘ë¦¬ */
				}

				/* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */

				button {
					background-color: #bb86fc; /* ë‹¤í¬ ëª¨ë“œì— ì–´ìš¸ë¦¬ëŠ” ìƒ‰ìƒ */
					color: #000; /* ë²„íŠ¼ ë‚´ í…ìŠ¤íŠ¸ ìƒ‰ìƒ */
					border: none;
				}

				button:hover {
					background-color: #9a67ea;
				}

				/* ë¹„ë””ì˜¤, ìë§‰ ì˜¤ë²„ë ˆì´ ë“± í•„ìš” ìš”ì†Œ ë°°ê²½ ì¡°ì • */

				.video-container,
				.video-wrapper,
				.current-subtitle-overlay {
					background-color: #121212;
				}

				/* ê¸°íƒ€ í•„ìš”í•œ ë‹¤í¬ ëª¨ë“œ ìŠ¤íƒ€ì¼ */

				.input-container,
				.url-input-group {
					/* í•„ìš”ì— ë”°ë¼ íŒ¨ë”©, ë§ˆì§„ ë“±ë„ ì¡°ì ˆ */
				}

				/* ì–¸ì–´ ì„ íƒ ë¦¬ìŠ¤íŠ¸ ë‹¤í¬ ëª¨ë“œ ìŠ¤íƒ€ì¼ */

				select {
					background-color: #1e1e1e !important;
					color: #e0e0e0 !important;
					border: 1px solid #333;
				}

				/* ì˜µì…˜ ìš”ì†Œì— ëŒ€í•œ ìŠ¤íƒ€ì¼ (ë¸Œë¼ìš°ì €ì— ë”°ë¼ í•„ìš”í•  ìˆ˜ ìˆìŒ) */

				select option {
					background-color: #1e1e1e;
					color: #e0e0e0;
				}
			}
		}
	</style>
	<style>
		body {
			font-family: Arial, sans-serif;
			max-width: 800px;
			margin: 0 auto;
			padding: 5px;
		}

		.input-container {
			display: flex;
			flex-direction: column;
			gap: 10px;
		}

		.url-input-group {
			display: flex;
			gap: 10px;
			align-items: center;
		}

		input[type="text"] {
			flex: 1;
			padding: 10px;
			font-size: 16px;
			border: 1px solid #ccc;
			border-radius: 5px;
		}

		select {
			width: 120px;
			padding: 8px;
			font-size: 14px;
			border: 1px solid #ccc;
			border-radius: 5px;
			background-color: white;
		}

		button {
			height: 40px;
			padding: 10px 20px;
			background-color: #ff0000;
			color: white;
			border: none;
			border-radius: 5px;
			cursor: pointer;
			font-size: 16px;
		}

		button:hover {
			background-color: #cc0000;
		}

		.video-container {
			margin-top: 20px;
			text-align: center;
		}

		.video-wrapper {
			width: 100%;
			aspect-ratio: 16 / 9;
		}

		iframe {
			width: 100%;
			height: 100%;
			border: none;
			border-radius: 10px;
		}

		.error-message {
			color: red;
			margin-top: 10px;
		}

		.subtitles-container {
			margin-top: 20px;
			max-height: 300px;
			overflow-y: auto;
			border: 1px solid #ccc;
			padding: 10px;
			border-radius: 5px;
		}

		.subtitle-item {
			margin-bottom: 10px;
			padding: 5px;
			background-color: #f5f5f5;
			border-radius: 3px;
		}

		.subtitle-item.active {
			color: red;
			background-color: #ffeb3b;
			font-weight: bold;
		}

		.subtitle-text {
			font-size: 14px;
		}

		.subtitle-time {
			color: #666;
			font-size: 12px;
		}

		.player-controls {
			margin-top: 10px;
			display: flex;
			align-items: center;
			justify-content: center;
			gap: 20px;
		}

		.current-time {
			font-size: 16px;
			font-family: monospace;
			background: #f5f5f5;
			padding: 5px 10px;
			border-radius: 5px;
			min-width: 80px;
		}

		.video-wrapper {
			position: relative;
			width: 100%;
		}

		.current-subtitle-overlay {
			position: absolute;
			bottom: 5%;
			left: 0;
			right: 0;
			z-index: 1000;
			background-color: rgba(0, 0, 0, 0.7);
			color: white;
			padding: 15px;
			text-align: center;
			font-size: 18px;
			font-weight: bold;
			text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
			transition: opacity 0.3s ease;
		}

		.current-subtitle-overlay.empty {
			opacity: 0;
		}

		.word {
			display: inline-block;
			cursor: pointer;
		}

		.word:hover {
			background-color: rgba(255, 255, 0, 0.3);
		}

		.word-popup {
			position: fixed;
			background: white;
			border: 1px solid #ccc;
			border-radius: 4px;
			padding: 10px;
			box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
			z-index: 1100;
			max-width: 300px;
			font-size: 14px;
			z-index: 1001;
		}

		.word-popup .meaning {
			margin-bottom: 5px;
		}

		.word-popup .pos {
			color: #666;
			font-style: italic;
		}

		.subtitle-header {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 5px;
		}

		.seek-icon {
			cursor: pointer;
			color: #666;
			font-size: 18px;
			padding: 5px;
			transition: color 0.2s ease;
		}

		.seek-icon:hover {
			color: #ff0000;
		}

		.icon-group {
			display: flex;
			gap: 10px;
			align-items: center;
		}

		.audio-loading {
			opacity: 0.5;
			pointer-events: none;
		}

		@keyframes spin {
			0% {
				transform: rotate(0deg);
			}
			100% {
				transform: rotate(360deg);
			}
		}

		.fa-spinner {
			animation: spin 1s linear infinite;
		}

		@import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css');

		.seek-icon.speaking {
			color: #ff0000;
			animation: pulse 1s infinite;
		}

		@keyframes pulse {
			0% {
				opacity: 1;
			}
			50% {
				opacity: 0.5;
			}
			100% {
				opacity: 1;
			}
		}
	</style>
</head>

<body ng-controller="YoutubeController">
<h1>ìœ íŠœë¸Œ ìë§‰ í”Œë ˆì´ì–´</h1>
<div class="input-container">
	<div class="url-input-group">
		<select ng-model="selectedLang">
			<option value="en">ğŸ‡ºğŸ‡¸ English</option>
			<option value="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
		</select>
		<input type="text" ng-model="youtubeUrl" placeholder="ìœ íŠœë¸Œ URLì„ ì…ë ¥í•˜ì„¸ìš”..."/>
	</div>
	<button ng-click="loadVideo()">ë™ì˜ìƒ ë¡œë“œ</button>
	<div class="error-message" ng-if="errorMessage">{{ errorMessage }}</div>
</div>
<div class="video-container" ng-if="videoId">
	<div class="video-wrapper">
		<div id="player"></div>
		<div class="current-subtitle-overlay" ng-if="currentSubtitle" ng-class="{'empty': !currentSubtitle}">
                <span style="margin-right: 5px;" ng-repeat="word in splitWords(currentSubtitle.text) track by $index"
											class="word"
											ng-click="showWordMeaning($event, word)">{{ word }}</span>&nbsp;
		</div>
	</div>
	<div class="player-controls">
		<button ng-click="togglePlay()">{{ isPlaying ? 'ì¼ì‹œì •ì§€' : 'ì¬ìƒ' }}</button>
		<div class="current-time">{{ currentTime | formatDuration }}</div>
	</div>
</div>
<div class="subtitles-container" ng-if="subtitles.length">
	<div ng-repeat="subtitle in subtitles track by $index"
			 class="subtitle-item"
			 ng-class="{'active': isCurrentSubtitle(subtitle)}"
			 id="subtitle-{{$index}}">
		<div class="subtitle-header">
			<div class="subtitle-time">{{ formatTime(subtitle.start) }} - {{ formatTime(subtitle.dur) }}</div>
			<div class="icon-group">
				<i class="fas fa-volume-up seek-icon"
					 ng-if="isSpeechSupported"
					 ng-click="playTTS(subtitle.text, $event, $index)"
					 title="í…ìŠ¤íŠ¸ë¥¼ ìŒì„±ìœ¼ë¡œ ì½ê¸°"></i>
				<i class="fas fa-play-circle seek-icon"
					 ng-click="seekToTime(subtitle.start)"
					 title="ì´ ì‹œê°„ìœ¼ë¡œ ì´ë™"></i>
			</div>
		</div>
		<div class="subtitle-text">
			{{ subtitle.text }}
		</div>
	</div>
</div>

<div class="word-popup" ng-if="selectedWord" ng-style="popupStyle" ng-if="wordMeanings">
	<div class="meaning" ng-repeat="meaning in wordMeanings">
		<span class="pos">{{ meaning.pos }}.</span> {{ meaning.definitions[0].definition }}
	</div>
</div>
</body>

</html>












